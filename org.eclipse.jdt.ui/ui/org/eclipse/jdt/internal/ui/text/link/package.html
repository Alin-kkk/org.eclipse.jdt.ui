<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta content="text/html; charset=iso-8859-1"
 http-equiv="Content-Type">
  <meta content="IBM" name="Author">
  <meta content="Mozilla/4.75 [en] (Windows NT 5.0; U) [Netscape]"
 name="GENERATOR">
  <title>Linked Position Infrastructure</title>
</head>
<body>
Application programming interfaces for interaction
with the Eclipse Java User Interface text support.
<h2>Linked Position Infrastructure</h2>
<h3>package <code>org.eclipse.jdt.internal.ui.text.link</code></h3>
The Linked Position Infrastructure lets one set up a mode in an editor
in which regions in a document (or several documents) are <em>linked</em>,
i.e. editions
of one linked position will be reflected in the others.
<h4>Classes</h4>
<ul>
  <li><code>PositionGroup</code>: a set of linked positions. Add
positions to a group using the <code>addPosition</code> methods, which
also allow to specify an iteration order, and completion proposals to
be shown when a position is hit.</li>
  <li><code>LinkedEnvironment</code>: umbrellas several <code>PositionGroup</code>s,
e.g. in a template that has several groups of linked positions. Handles
the forwarding of updates received via an IDocumentListener. Add <code>PositionGroup</code>s
to
an environment using the <code>addGroup</code> method. A linked
environment can be obtained using one of the provided static methods.</li>
  <li><code>LinkedUIControl</code>: The UI for linked mode (for one
environment, to be precise). Monitors key etc. activity, monitors exit
conditions, creates a painter etc. <br>
Properties:
    <ul>
      <li><b>cycling mode</b> (whether to jump to the first position
after the last): either of <code>CYCLE_ALWAYS</code>, <code>CYCLE_NEVER</code>
and <code>CYCLE_WHEN_NO_PARENT</code> (default).</li>
      <li><b>exit position</b>: where to jump upon leaving the linked
mode (e.g. using Enter, or Tab from the last position when not
cycling). Set <code>isTabStop</code> to <code>true</code> if tabbing
should stop over when cycling.</li>
    </ul>
  </li>
.
</ul>
<h4>Example</h4>
<pre>	IDocument doc1, doc2;<br>	ITextViewer viewer1, viewer2;<br>	<br>	/* create groups - this step is independent of the linked mode */<br>	PositionGroup group1= new PositionGroup();<br>	group1.addPosition(doc1, 3,4);<br>	group1.addPosition(doc1, 7,8);<br>	<br>	PositionGroup group2= newPositionGroup();<br>	group2.addPosition(doc1, 15, 25);<br>	group2.addPosition(doc2, 0, 10);<br>	<br>	/* set up linked mode */<br>	LinkedEnvironment env= LinkedEnvironment.createEnvironment(new IDocument[] {doc1, doc2});<br>	env.addGroup(group1);<br>	env.addGroup(group2);<br>	<br>	/* create UI */<br>	LinkedUIControl ui= new LinkedUIControl(env, new ITextViewer[] { viewer1, viewer2 });<br>	ui.enter();<br></pre>
<h4>Todo</h4>
Items with an asterix (*) are must haves before merging this into HEAD.
<ul>
  <li>handle closing behaviour on shell deactivation (make sure we
don't exit if a code completion window gets focus).</li>
  <ul>
    <li>This can be handles as in the old LinkedPositionUI.<br>
    </li>
  </ul>
  <li>handle lazy computation of per-group proposals using a <code>IContentAssistProcessor</code>
(see PositionGroup) .</li>
  <li>handle interaction with the standard context information popup
(since it is a verify key listener, it does not get informed about
caret changes if we filter them away in front of it. Need some other
information flow).</li>
  <ul>
    <li>Steps:</li>
    <ul>
      <li>Create a new class like the one below:<br>
      </li>
    </ul>
  </ul>
</ul>
<pre>		class Clazz {<br>		<br>			int kompute(int param) {<br>				return kompute&lt;CARET&gt;;<br>			}<br>		}<br></pre>
<ul>
  <ul>
    <ul>
      <li>Invoke content assist with "automatically insert single
proposals" turned on.</li>
      <li>Repeat recursively placing new invocations of <span
 style="font-family: monospace;">kompute</span> as the parameter of the
function.</li>
      <ul>
        <li>Note: as we step down recursively, the context info box
comes along and displays the parameter info.</li>
      </ul>
      <ul>
        <li>Note: the linked mode follows into the recursion</li>
      </ul>
      <li>Finally enter a different parameter (e.g. 2) and press TAB to
leave one level</li>
      <ul>
        <li>Note: one link level is left, the surrounding entry is
underlined</li>
        <li>Note: the context info stays with the innermost parameter.</li>
      </ul>
      <li>Press TAB repeatedly until behind the last closing
parenthesis - all linked modes have been left</li>
      <ul>
        <li>Note: the context info is still with the innermost
parameter.</li>
      </ul>
      <li>Press ESC repeatedly to see the context info jump back from
level to level.<br>
      </li>
    </ul>
  </ul>
</ul>
<pre>	<br></pre>
</body>
</html>
